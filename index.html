<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>K·∫ø Ho·∫°ch Dinh D∆∞·ª°ng & T·∫≠p Luy·ªán C√° Nh√¢n</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body class="bg-gray-100 min-h-screen flex flex-col items-center justify-center p-4">
    <div class="bg-white shadow-2xl rounded-2xl p-8 w-full max-w-4xl" id="reportSection">
        <h1 class="text-3xl font-bold text-center text-blue-700 mb-6">üìã B√°o C√°o K·∫ø Ho·∫°ch C√° Nh√¢n</h1>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
            <input id="name" type="text" placeholder="T√™n h·ªôi vi√™n" class="border rounded-xl p-2">
            <input id="contact" type="text" placeholder="Li√™n h·ªá (SƒêT/Email)" class="border rounded-xl p-2">
            <input id="weight" type="number" placeholder="C√¢n n·∫∑ng hi·ªán t·∫°i (kg)" class="border rounded-xl p-2">
            <input id="height" type="number" placeholder="Chi·ªÅu cao (cm)" class="border rounded-xl p-2">
            <input id="age" type="number" placeholder="Tu·ªïi" class="border rounded-xl p-2">
            <select id="gender" class="border rounded-xl p-2">
                <option value="Nam">Nam</option>
                <option value="N·ªØ">N·ªØ</option>
            </select>
            <input id="goalWeight" type="number" placeholder="M·ª•c ti√™u c√¢n n·∫∑ng (kg)" class="border rounded-xl p-2">
            <input id="duration" type="number" placeholder="Th·ªùi gian (th√°ng)" class="border rounded-xl p-2">
            <input id="frequency" type="number" placeholder="S·ªë bu·ªïi t·∫≠p/tu·∫ßn" class="border rounded-xl p-2">
            <div>
                <label class="font-medium">Ch·ªçn t·ª∑ l·ªá Macro (%)</label>
                <div class="grid grid-cols-3 gap-2">
                    <input id="protein" type="number" placeholder="Protein" class="border rounded-xl p-2" value="30">
                    <input id="carbs" type="number" placeholder="Carbs" class="border rounded-xl p-2" value="50">
                    <input id="fats" type="number" placeholder="Fats" class="border rounded-xl p-2" value="20">
                </div>
            </div>
        </div>
        <div class="text-center">
            <button onclick="generatePlan()" class="bg-green-500 hover:bg-green-600 text-white py-2 px-6 rounded-2xl text-lg">‚ú® T·∫°o K·∫ø Ho·∫°ch</button>
        </div>

        <div id="generatedPlan" class="hidden mt-8 bg-white p-8 rounded-2xl shadow-2xl border border-gray-200 relative">
            <div class="flex justify-between items-start mb-4">
                <h2 class="text-3xl font-bold text-blue-600">üéØ K·∫ø Ho·∫°ch C√° Nh√¢n Ho√†n Ch·ªânh</h2>
                <div class="text-gray-500 text-xs">Ng√†y: <span id="displayDate">24/02/2025</span></div>
            </div>
            <div id="planContent" class="space-y-6">
                <!-- Th√¥ng tin h·ªôi vi√™n -->
                <div class="bg-blue-50 p-4 rounded-xl">
                    <h3 class="text-lg font-semibold text-blue-700 mb-2">üë§ Th√¥ng Tin H·ªôi Vi√™n</h3>
                    <p><span class="font-medium text-gray-700">T√™n:</span> <span id="displayName" class="text-blue-800"></span></p>
                    <p><span class="font-medium text-gray-700">Li√™n h·ªá:</span> <span id="displayContact" class="text-blue-800"></span></p>
                </div>

                <!-- Th√¥ng tin c∆° b·∫£n -->
                <div class="bg-green-50 p-4 rounded-xl">
                    <h3 class="text-lg font-semibold text-green-700 mb-2">üìä Th√¥ng Tin C∆° B·∫£n</h3>
                    <p><span class="font-medium text-gray-700">C√¢n n·∫∑ng:</span> <span id="displayWeight" class="text-green-800 font-bold"></span> kg</p>
                    <p><span class="font-medium text-gray-700">Chi·ªÅu cao:</span> <span id="displayHeight" class="text-green-800 font-bold"></span> cm</p>
                    <p><span class="font-medium text-gray-700">Tu·ªïi:</span> <span id="displayAge" class="text-green-800 font-bold"></span></p>
                    <p><span class="font-medium text-gray-700">Gi·ªõi t√≠nh:</span> <span id="displayGender" class="text-green-800 font-bold"></span></p>
                    <p><span class="font-medium text-gray-700">BMI:</span> <span id="displayBMI" class="text-green-800 font-bold"></span></p>
                </div>

                <!-- M·ª•c ti√™u -->
                <div class="bg-yellow-50 p-4 rounded-xl">
                    <h3 class="text-lg font-semibold text-yellow-700 mb-2">üéØ M·ª•c Ti√™u</h3>
                    <p><span class="font-medium text-gray-700">Lo·∫°i m·ª•c ti√™u:</span> <span id="displayGoalType" class="text-yellow-800 font-bold"></span></p>
                    <p><span class="font-medium text-gray-700">Thay ƒë·ªïi c√¢n n·∫∑ng:</span> <span id="displayWeightChange" class="text-yellow-800 font-bold"></span> kg trong <span id="displayDuration" class="text-yellow-800 font-bold"></span> th√°ng</p>
                    <p><span class="font-medium text-gray-700">T·ªëc ƒë·ªô thay ƒë·ªïi:</span> <span id="displayMonthlyChange" class="text-yellow-800 font-bold"></span> kg/th√°ng</p>
                </div>

                <!-- K·∫ø ho·∫°ch dinh d∆∞·ª°ng -->
                <div class="bg-purple-50 p-4 rounded-xl">
                    <h3 class="text-lg font-semibold text-purple-700 mb-2">üçΩÔ∏è K·∫ø Ho·∫°ch Dinh D∆∞·ª°ng</h3>
                    <p><span class="font-medium text-gray-700">Calo m·ª•c ti√™u:</span> <span id="displayCalTarget" class="text-purple-800 font-bold"></span> calo/ng√†y</p>
                    <p><span class="font-medium text-gray-700">Protein:</span> <span id="displayProtein" class="text-purple-800 font-bold"></span> g</p>
                    <p><span class="font-medium text-gray-700">Carbs:</span> <span id="displayCarbs" class="text-purple-800 font-bold"></span> g</p>
                    <p><span class="font-medium text-gray-700">Fats:</span> <span id="displayFats" class="text-purple-800 font-bold"></span> g</p>
                    <p><span class="font-medium text-gray-700">N∆∞·ªõc u·ªëng:</span> <span id="displayWater" class="text-purple-800 font-bold"></span> L/ng√†y</p>
                    <div class="mt-4 flex justify-center">
                        <canvas id="macroChart" width="150" height="150"></canvas>
                    </div>
                </div>

                <!-- L·ªãch t·∫≠p luy·ªán -->
                <div class="bg-red-50 p-4 rounded-xl">
                    <h3 class="text-lg font-semibold text-red-700 mb-2">üèãÔ∏è L·ªãch T·∫≠p Luy·ªán</h3>
                    <p><span class="font-medium text-gray-700">T·∫ßn su·∫•t:</span> <span id="displayFrequency" class="text-red-800 font-bold"></span> bu·ªïi/tu·∫ßn</p>
                </div>
            </div>

            <!-- L∆∞u √Ω -->
            <div class="mt-6 border-t pt-4">
                <h3 class="font-semibold text-lg text-gray-800 mb-2">üîë L∆∞u √ù T·ª´ Hu·∫•n Luy·ªán Vi√™n</h3>
                <ul class="list-disc list-inside text-gray-700 space-y-2">
                    <li>ƒê·∫£m b·∫£o t·ªâ l·ªá Macro ph√π h·ª£p v·ªõi m·ª•c ti√™u (Protein, Carbs, Fats).</li>
                    <li>Duy tr√¨ ch·∫ø ƒë·ªô ƒÉn v√† t·∫≠p luy·ªán ƒë·ªÅu ƒë·∫∑n.</li>
                    <li>Ki·ªÉm tra ti·∫øn ƒë·ªô m·ªói th√°ng ƒë·ªÉ ƒëi·ªÅu ch·ªânh k·∫ø ho·∫°ch.</li>
                </ul>
            </div>

            <!-- ƒê·ªÅ xu·∫•t th·ª±c ph·∫©m b·ªï sung -->
            <div class="mt-6 bg-orange-50 p-4 rounded-xl">
                <h3 class="text-lg font-semibold text-orange-700 mb-2">üíä ƒê·ªÅ Xu·∫•t Th·ª±c Ph·∫©m B·ªï Sung</h3>
                <p class="text-orange-800">ƒê·ªÉ h·ªó tr·ª£ t·ªët nh·∫•t cho k·∫ø ho·∫°ch c·ªßa b·∫°n, h√£y th·ª≠ c√°c s·∫£n ph·∫©m:</p>
                <ul class="list-disc list-inside text-orange-800 space-y-1">
                    <li><strong>Whey Protein:</strong> Gi√∫p ph·ª•c h·ªìi c∆° b·∫Øp nhanh ch√≥ng sau t·∫≠p, cung c·∫•p protein ch·∫•t l∆∞·ª£ng cao.</li>
                    <li><strong>BCAA:</strong> Gi·∫£m m·ªát m·ªèi, tƒÉng s·ª©c b·ªÅn trong su·ªët bu·ªïi t·∫≠p.</li>
                    <li><strong>Creatine:</strong> TƒÉng s·ª©c m·∫°nh v√† hi·ªáu su·∫•t, l√Ω t∆∞·ªüng cho c√°c b√†i t·∫≠p n·∫∑ng.</li>
                </ul>
                <p class="text-orange-800 mt-2">K·∫øt h·ª£p c·∫£ 3 ƒë·ªÉ ƒë·∫°t hi·ªáu qu·∫£ t·ªëi ∆∞u nh√©!</p>
            </div>

            <!-- L·ªùi khuy√™n -->
            <div class="mt-6 bg-teal-50 p-4 rounded-xl">
                <h3 class="text-lg font-semibold text-teal-700 mb-2">ü§ù L·ªùi Khuy√™n</h3>
                <p id="advice" class="text-teal-800 italic"></p>
            </div>

            <!-- Watermark -->
            <div class="absolute top-0 left-0 w-full h-full opacity-5 pointer-events-none flex items-center justify-center text-gray-400 text-2xl font-bold transform rotate-45">MDNG-30422</div>
        </div>

        <!-- N√∫t t·∫£i xu·ªëng -->
        <div class="text-center mt-6">
            <button onclick="downloadPNG()" class="bg-blue-500 hover:bg-blue-600 text-white py-2 px-6 rounded-2xl">üì• T·∫£i Xu·ªëng PNG</button>
        </div>
    </div>

    <script>
        let macroChart;

        function calculateBMI(weight, height) {
            return (weight / Math.pow(height / 100, 2)).toFixed(1);
        }

        function determineGoal(weight, goalWeight) {
            if (weight < goalWeight) return "TƒÉng c√¢n";
            if (weight > goalWeight) return "Gi·∫£m c√¢n";
            return "Duy tr√¨";
        }

        function calculatePlan(weight, goalWeight, duration, proteinPercent, carbsPercent, fatsPercent) {
            const totalChange = Math.abs(weight - goalWeight);
            const monthlyChange = (totalChange / duration).toFixed(1);

            const BMR = (weight * 22 * 1).toFixed(0);
            const TDEE = (BMR * 1.55).toFixed(0);
            const calTarget = (weight < goalWeight ? parseInt(TDEE) + 300 : parseInt(TDEE) - 500);
            const protein = ((calTarget * (proteinPercent / 100)) / 4).toFixed(1);
            const carbs = ((calTarget * (carbsPercent / 100)) / 4).toFixed(1);
            const fats = ((calTarget * (fatsPercent / 100)) / 9).toFixed(1);
            const water = (weight * 0.035).toFixed(1); // 35ml/kg

            return { BMR, TDEE, calTarget, protein, carbs, fats, monthlyChange, water };
        }

        function generateAdvice(age, gender, goalType) {
            let advice = "";
            if (age && parseInt(age) > 30 && gender === "Nam" && goalType === "TƒÉng c√¢n") {
                advice = "N·∫øu b·∫°n tr√™n 30, h√£y th·ª≠ b·ªï sung th√™m protein t·ª´ ƒë·∫≠u ho·∫∑c h·∫°t ƒë·ªÉ v·ª´a tƒÉng c∆° v·ª´a d·ªÖ ti√™u h√≥a nh√©.";
            } else if (gender === "N·ªØ" && goalType === "Gi·∫£m c√¢n") {
                advice = "B·∫°n n√™n ƒÉn nhi·ªÅu rau xanh v√† c·∫Øt b·ªõt tinh b·ªôt kh√¥ng t·ªët ƒë·ªÉ gi·∫£m c√¢n hi·ªáu qu·∫£ h∆°n.";
            } else if (goalType === "Duy tr√¨") {
                advice = "Gi·ªØ m·ªçi th·ª© c√¢n b·∫±ng th√¥i, v·ª´a t·∫≠p nh·∫π nh√†ng v·ª´a ƒÉn ƒë·ªß ch·∫•t l√† ·ªïn.";
            } else if (age && parseInt(age) < 25) {
                advice = "Tr·∫ª kh·ªèe th√¨ tranh th·ªß t·∫≠p m·∫°nh m·ªôt ch√∫t, c∆° th·ªÉ b·∫°n ƒëang r·∫•t s·∫µn s√†ng ƒë·ªÉ ph√°t tri·ªÉn ƒë·∫•y!";
            } else {
                advice = "C·ª© b√¨nh tƒ©nh, t·ª´ng b∆∞·ªõc ƒëi·ªÅu ch·ªânh ƒÉn u·ªëng v√† t·∫≠p luy·ªán l√† s·∫Ω ƒë·∫°t m·ª•c ti√™u th√¥i.";
            }
            return advice;
        }

        function generatePlan() {
            const name = document.getElementById("name").value;
            const contact = document.getElementById("contact").value;
            const weight = parseFloat(document.getElementById("weight").value);
            const height = parseFloat(document.getElementById("height").value);
            const age = document.getElementById("age").value;
            const gender = document.getElementById("gender").value;
            const goalWeight = parseFloat(document.getElementById("goalWeight").value);
            const duration = parseInt(document.getElementById("duration").value);
            const frequency = parseInt(document.getElementById("frequency").value);
            const proteinPercent = parseFloat(document.getElementById("protein").value);
            const carbsPercent = parseFloat(document.getElementById("carbs").value);
            const fatsPercent = parseFloat(document.getElementById("fats").value);

            if (!weight || !height || !goalWeight || !duration || !frequency) {
                alert("Vui l√≤ng ƒëi·ªÅn ƒë·∫ßy ƒë·ªß th√¥ng tin!");
                return;
            }

            const bmi = calculateBMI(weight, height);
            const goalType = determineGoal(weight, goalWeight);
            const { calTarget, protein, carbs, fats, monthlyChange, water } = calculatePlan(weight, goalWeight, duration, proteinPercent, carbsPercent, fatsPercent);

            document.getElementById("displayName").textContent = name || "Kh√¥ng x√°c ƒë·ªãnh";
            document.getElementById("displayContact").textContent = contact || "Kh√¥ng c√≥";
            document.getElementById("displayWeight").textContent = weight.toLocaleString();
            document.getElementById("displayHeight").textContent = height.toLocaleString();
            document.getElementById("displayAge").textContent = age || "Kh√¥ng x√°c ƒë·ªãnh";
            document.getElementById("displayGender").textContent = gender;
            document.getElementById("displayBMI").textContent = bmi;
            document.getElementById("displayGoalType").textContent = goalType;
            document.getElementById("displayWeightChange").textContent = Math.abs(weight - goalWeight).toLocaleString();
            document.getElementById("displayDuration").textContent = duration.toLocaleString();
            document.getElementById("displayMonthlyChange").textContent = monthlyChange;
            document.getElementById("displayCalTarget").textContent = calTarget.toLocaleString();
            document.getElementById("displayProtein").textContent = protein;
            document.getElementById("displayCarbs").textContent = carbs;
            document.getElementById("displayFats").textContent = fats;
            document.getElementById("displayFrequency").textContent = frequency.toLocaleString();
            document.getElementById("displayWater").textContent = water;

            // Ng√†y hi·ªán t·∫°i
            document.getElementById("displayDate").textContent = "24/02/2025";

            // L·ªùi khuy√™n
            document.getElementById("advice").textContent = generateAdvice(age, gender, goalType);

            // T·∫°o bi·ªÉu ƒë·ªì Macro
            if (macroChart) macroChart.destroy();
            const ctx = document.getElementById("macroChart").getContext("2d");
            macroChart = new Chart(ctx, {
                type: "doughnut",
                data: {
                    labels: ["Protein", "Carbs", "Fats"],
                    datasets: [{
                        data: [proteinPercent, carbsPercent, fatsPercent],
                        backgroundColor: ["#ff6384", "#36a2eb", "#ffce56"],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: false,
                    plugins: {
                        legend: {
                            position: "bottom",
                            labels: { font: { size: 10 } }
                        }
                    }
                }
            });

            document.getElementById("generatedPlan").classList.remove("hidden");
        }

        function downloadPNG() {
            const planSection = document.getElementById("generatedPlan");
            html2canvas(planSection).then((canvas) => {
                const link = document.createElement("a");
                link.download = "Ke_Hoach_Ca_Nhan.png";
                link.href = canvas.toDataURL("image/png");
                link.click();
            });
        }
    </script>
</body>
</html>
